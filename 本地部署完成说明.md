# Computer Use Agent æœ¬åœ°éƒ¨ç½²å®Œæˆè¯´æ˜

## âœ… éƒ¨ç½²çŠ¶æ€

é¡¹ç›®å·²æˆåŠŸé…ç½®ä¸º**å®Œå…¨æœ¬åœ°è¿è¡Œæ¨¡å¼**,æ— éœ€ä¾èµ–è¿œç¨‹æ²™ç®±æœåŠ¡ã€‚

## ğŸ¯ å®Œæˆçš„å·¥ä½œ

### 1. åç«¯ä¿®æ”¹

#### Planner æœåŠ¡
- **æ–‡ä»¶**: `planner/src/planner/client/sandbox_manager_client.py`
  - æ–°å¢ `LocalSandboxManager` ç±»,ç”¨äºæœ¬åœ°æ¨¡å¼
  - ä¿ç•™ `ECSSandboxManager` ç±»,ç”¨äºè¿œç¨‹æ²™ç®±æ¨¡å¼
  
- **æ–‡ä»¶**: `planner/src/planner/app.py`
  - ä¿®æ”¹ä¸ºä½¿ç”¨ `LocalSandboxManager` è€Œä¸æ˜¯ `ECSSandboxManager`
  - æœ¬åœ°æ¨¡å¼ä¸‹ç›´æ¥è¿”å›æœ¬åœ° Tool Server åœ°å€ `http://127.0.0.1:8102`

#### é…ç½®æ–‡ä»¶
- **æ–‡ä»¶**: `planner/config.toml`
  - å·²é…ç½® API Key: `YOUR_API_KEY_HERE`
  - å·²é…ç½®æœ¬åœ° MCP Server: `http://127.0.0.1:8000`
  - å·²é…ç½®æœ¬åœ° Tool Server: `http://127.0.0.1:8102`

### 2. å‰ç«¯ä¿®æ”¹

æ‰€æœ‰æ²™ç®±ç›¸å…³çš„ API è·¯ç”±éƒ½å·²ä¿®æ”¹ä¸ºæ”¯æŒæœ¬åœ°æ¨¡å¼:

#### API è·¯ç”±ä¿®æ”¹
- **`frontend/src/app/api/sandbox/list/route.ts`**
  - æ·»åŠ  `USE_LOCAL_MODE = true` å¼€å…³
  - æœ¬åœ°æ¨¡å¼ä¸‹è¿”å›è™šæ‹Ÿçš„æœ¬åœ°æ²™ç®±å®ä¾‹:
    ```json
    {
      "SandboxId": "local-sandbox",
      "PrimaryIp": "127.0.0.1",
      "Eip": "127.0.0.1",
      "Status": "RUNNING",
      "OsType": "Linux"
    }
    ```

- **`frontend/src/app/api/sandbox/create/route.ts`**
  - æ·»åŠ  `USE_LOCAL_MODE = true` å¼€å…³
  - æœ¬åœ°æ¨¡å¼ä¸‹ç›´æ¥è¿”å›æœ¬åœ°æ²™ç®±å®ä¾‹,æ— éœ€åˆ›å»º

- **`frontend/src/app/api/sandbox/delete/route.ts`**
  - æ·»åŠ  `USE_LOCAL_MODE = true` å¼€å…³
  - æœ¬åœ°æ¨¡å¼ä¸‹ç›´æ¥è¿”å›æˆåŠŸ,æ— éœ€åˆ é™¤æ“ä½œ

- **`frontend/src/app/api/sandbox/terminal-url/route.ts`**
  - æ·»åŠ  `USE_LOCAL_MODE = true` å¼€å…³
  - æœ¬åœ°æ¨¡å¼ä¸‹è¿”å›ç©º URL(æœ¬åœ°ä¸éœ€è¦è¿œç¨‹æ¡Œé¢)

### 3. è‡ªåŠ¨åŒ–è„šæœ¬

- **`start-all.sh`**: ä¸€é”®å¯åŠ¨æ‰€æœ‰æœåŠ¡
- **`stop-all.sh`**: ä¸€é”®åœæ­¢æ‰€æœ‰æœåŠ¡

## ğŸš€ å½“å‰è¿è¡ŒçŠ¶æ€

æ‰€æœ‰æœåŠ¡å·²æˆåŠŸå¯åŠ¨å¹¶è¿è¡Œ:

```
âœ“ Tool Server:   http://127.0.0.1:8102 (PID: 42499)
âœ“ MCP Server:    http://127.0.0.1:8000 (PID: 42618)
âœ“ Planner:       http://127.0.0.1:8089 (PID: 42782)
âœ“ Frontend:      http://127.0.0.1:3000 (PID: 42886)
```

## ğŸ“ éªŒè¯æµ‹è¯•

### 1. å¥åº·æ£€æŸ¥
```bash
curl http://localhost:8089/health
# è¿”å›: {"status":"ok","service":"agent-planner"}
```

### 2. æ²™ç®±åˆ—è¡¨
```bash
curl http://localhost:3000/api/sandbox/list
# è¿”å›æœ¬åœ°æ²™ç®±å®ä¾‹
```

### 3. åˆ›å»ºæ²™ç®±
```bash
curl -X POST http://localhost:3000/api/sandbox/create \
  -H "Content-Type: application/json" \
  -d '{"OsType":"Linux"}'
# è¿”å›æœ¬åœ°æ²™ç®±å®ä¾‹
```

## ğŸ® ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨æœåŠ¡
```bash
cd ai-app-lab/demohouse/computer_use
./start-all.sh
```

### è®¿é—®å‰ç«¯
åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€: http://localhost:3000

### ä½¿ç”¨æµç¨‹
1. å‰ç«¯ä¼šè‡ªåŠ¨åŠ è½½æœ¬åœ°æ²™ç®±å®ä¾‹ `local-sandbox`
2. åœ¨ç•Œé¢ä¸­è¾“å…¥è‡ªç„¶è¯­è¨€æŒ‡ä»¤
3. AI ä»£ç†ä¼šé€šè¿‡ä»¥ä¸‹æµç¨‹æ‰§è¡Œä»»åŠ¡:
   - Frontend â†’ Planner (ç«¯å£ 8089)
   - Planner â†’ MCP Server (ç«¯å£ 8000)
   - MCP Server â†’ Tool Server (ç«¯å£ 8102)
   - Tool Server åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šæ‰§è¡Œå®é™…æ“ä½œ

### åœæ­¢æœåŠ¡
```bash
./stop-all.sh
```

## ğŸ”§ æŠ€æœ¯æ¶æ„

### æœ¬åœ°æ¨¡å¼å·¥ä½œæµç¨‹

```
ç”¨æˆ·è¾“å…¥æŒ‡ä»¤
    â†“
Frontend (Next.js)
    â†“
Planner (FastAPI)
    â”œâ”€ LocalSandboxManager (è¿”å›æœ¬åœ°åœ°å€)
    â””â”€ è°ƒç”¨ MCP Server
        â†“
MCP Server (FastMCP)
    â””â”€ è°ƒç”¨ Tool Server
        â†“
Tool Server (FastAPI)
    â””â”€ æ‰§è¡Œæœ¬åœ°æ“ä½œ (é¼ æ ‡ã€é”®ç›˜ã€æˆªå›¾ç­‰)
```

### å…³é”®ç»„ä»¶

1. **LocalSandboxManager**
   - æ›¿ä»£è¿œç¨‹æ²™ç®±ç®¡ç†å™¨
   - ç›´æ¥è¿”å›æœ¬åœ° Tool Server åœ°å€
   - æ— éœ€ç½‘ç»œè¯·æ±‚

2. **è™šæ‹Ÿæœ¬åœ°æ²™ç®±**
   - SandboxId: `local-sandbox`
   - çŠ¶æ€: `RUNNING`
   - åœ°å€: `127.0.0.1`

3. **æœ¬åœ° Tool Server**
   - ç›´æ¥åœ¨æœ¬æœºæ‰§è¡Œæ“ä½œ
   - æ— éœ€è¿œç¨‹è¿æ¥
   - æ›´å¿«çš„å“åº”é€Ÿåº¦

## ğŸ“Š ä¸è¿œç¨‹æ¨¡å¼çš„å¯¹æ¯”

| ç‰¹æ€§ | æœ¬åœ°æ¨¡å¼ | è¿œç¨‹æ²™ç®±æ¨¡å¼ |
|------|---------|-------------|
| æ²™ç®±ç®¡ç†å™¨ | LocalSandboxManager | ECSSandboxManager |
| Tool Server | æœ¬åœ° (127.0.0.1:8102) | è¿œç¨‹ ECS å®ä¾‹ |
| ç½‘ç»œå»¶è¿Ÿ | æ—  | æœ‰ |
| éƒ¨ç½²å¤æ‚åº¦ | ä½ | é«˜ |
| å®‰å…¨éš”ç¦» | æ—  | æœ‰ |
| é€‚ç”¨åœºæ™¯ | å¼€å‘æµ‹è¯•ã€ä¸ªäººä½¿ç”¨ | ç”Ÿäº§ç¯å¢ƒã€å¤šç”¨æˆ· |

## ğŸ”„ åˆ‡æ¢åˆ°è¿œç¨‹æ¨¡å¼

å¦‚æœéœ€è¦åˆ‡æ¢åˆ°è¿œç¨‹æ²™ç®±æ¨¡å¼,è¯·å‚è€ƒ `æœ¬åœ°éƒ¨ç½²è¯´æ˜.md` ä¸­çš„"åˆ‡æ¢åˆ°è¿œç¨‹æ²™ç®±æ¨¡å¼"ç« èŠ‚ã€‚

ä¸»è¦æ­¥éª¤:
1. ä¿®æ”¹ `planner/src/planner/app.py` ä½¿ç”¨ `ECSSandboxManager`
2. é…ç½® `planner/config.toml` ä¸­çš„ `manager_endpoint`
3. ä¿®æ”¹æ‰€æœ‰å‰ç«¯ API è·¯ç”±ä¸­çš„ `USE_LOCAL_MODE = false`
4. é‡å¯æ‰€æœ‰æœåŠ¡

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `æœ¬åœ°éƒ¨ç½²è¯´æ˜.md` - è¯¦ç»†çš„éƒ¨ç½²å’Œé…ç½®è¯´æ˜
- `README.md` - é¡¹ç›®åŸå§‹è¯´æ˜æ–‡æ¡£
- `planner/README.md` - Planner æœåŠ¡è¯´æ˜
- `mcp_server/README.md` - MCP Server è¯´æ˜
- `tool_server/README.md` - Tool Server è¯´æ˜
- `frontend/README.md` - Frontend è¯´æ˜

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å®‰å…¨æ€§**: æœ¬åœ°æ¨¡å¼ä¸‹,Tool Server å¯ä»¥ç›´æ¥æ“ä½œæœ¬åœ°è®¡ç®—æœº,è¯·è°¨æ…ä½¿ç”¨
2. **æƒé™**: æŸäº›æ“ä½œå¯èƒ½éœ€è¦ç®¡ç†å‘˜æƒé™
3. **å…¼å®¹æ€§**: ç›®å‰åœ¨ macOS ä¸Šæµ‹è¯•é€šè¿‡,å…¶ä»–ç³»ç»Ÿå¯èƒ½éœ€è¦è°ƒæ•´
4. **API Key**: ç¡®ä¿ç«å±±æ–¹èˆŸ API Key æœ‰æ•ˆä¸”æœ‰è¶³å¤Ÿé¢åº¦

## ğŸ‰ æ€»ç»“

é¡¹ç›®å·²æˆåŠŸé…ç½®ä¸ºå®Œå…¨æœ¬åœ°è¿è¡Œæ¨¡å¼:
- âœ… æ— éœ€è¿œç¨‹æ²™ç®±æœåŠ¡
- âœ… æ‰€æœ‰æœåŠ¡åœ¨æœ¬åœ°è¿è¡Œ
- âœ… ä¸€é”®å¯åŠ¨/åœæ­¢è„šæœ¬
- âœ… å®Œæ•´çš„æœ¬åœ°æ²™ç®±æ¨¡æ‹Ÿ
- âœ… å‰åç«¯å®Œå…¨æ‰“é€š

ç°åœ¨å¯ä»¥ç›´æ¥è®¿é—® http://localhost:3000 å¼€å§‹ä½¿ç”¨ Computer Use Agent!

